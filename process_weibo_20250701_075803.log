2025-07-01 07:58:03,658 - INFO - 开始处理微博数据...
2025-07-01 07:58:03,658 - INFO - 输入文件: /home/zss/Social_Behavior_Simulation/data_prepocess/Ruby_Face_Cream_r0.json
2025-07-01 07:58:03,658 - INFO - 输出JSON文件: /home/zss/Social_Behavior_Simulation/data_prepocess/sft_data.jsonl
2025-07-01 07:58:03,658 - INFO - 输出Parquet文件: /home/zss/Social_Behavior_Simulation/data_prepocess/sft_data.parquet
2025-07-01 07:58:03,658 - INFO - 输入文件大小: 813.78 MB
2025-07-01 07:58:03,659 - INFO - 正在计算文件行数...
2025-07-01 07:58:04,963 - INFO - 总行数: 235
2025-07-01 07:58:18,141 - INFO - 
处理完成:
2025-07-01 07:58:18,141 - INFO - 总共处理了 235 条有效微博数据
2025-07-01 07:58:18,141 - INFO - 生成了 235 个训练样本
2025-07-01 07:58:18,141 - INFO - 错误数量: 0
2025-07-01 07:58:18,141 - INFO - 正在保存最终结果...
2025-07-01 07:58:18,143 - INFO - 正在转换为Parquet格式...
2025-07-01 07:58:18,145 - ERROR - 保存文件时出错: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-07-01 07:58:18,145 - ERROR - 处理过程中发生错误：Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.
2025-07-01 07:58:18,147 - ERROR - Traceback (most recent call last):
  File "/home/zss/Social_Behavior_Simulation/data_prepocess/data1.py", line 351, in main
    sft_data = process_weibo_data(input_file, output_json, output_parquet, checkpoint_interval)
  File "/home/zss/Social_Behavior_Simulation/data_prepocess/data1.py", line 302, in process_weibo_data
    df.to_parquet(output_parquet, index=False)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zss/miniconda3/envs/Social_behavior/lib/python3.13/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "/home/zss/miniconda3/envs/Social_behavior/lib/python3.13/site-packages/pandas/core/frame.py", line 3113, in to_parquet
    return to_parquet(
        self,
    ...<6 lines>...
        **kwargs,
    )
  File "/home/zss/miniconda3/envs/Social_behavior/lib/python3.13/site-packages/pandas/io/parquet.py", line 476, in to_parquet
    impl = get_engine(engine)
  File "/home/zss/miniconda3/envs/Social_behavior/lib/python3.13/site-packages/pandas/io/parquet.py", line 67, in get_engine
    raise ImportError(
    ...<7 lines>...
    )
ImportError: Unable to find a usable engine; tried using: 'pyarrow', 'fastparquet'.
A suitable version of pyarrow or fastparquet is required for parquet support.
Trying to import the above resulted in these errors:
 - Missing optional dependency 'pyarrow'. pyarrow is required for parquet support. Use pip or conda to install pyarrow.
 - Missing optional dependency 'fastparquet'. fastparquet is required for parquet support. Use pip or conda to install fastparquet.

